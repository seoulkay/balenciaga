<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Grayscale - Start Bootstrap Theme</title>
        <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.13.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
            <div class="container">
                <a class="navbar-brand js-scroll-trigger" href="#page-top">Start Bootstrap</a>
                <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#about">About</a></li>
                        <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#projects">Projects</a></li>
                        <li class="nav-item"><a class="nav-link js-scroll-trigger" href="#signup">Contact</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Masthead-->
        <header class="masthead">
            <div class="container d-flex h-100 align-items-center">
                <div class="mx-auto text-center">
                    <h1 class="mx-auto my-0 text-uppercase" id="title1">Grayscale</h1>
                    <h4 class="text-white-50 mx-auto mt-2 mb-5" id="titleDesc">A free, responsive, one page Bootstrap theme created by Start Bootstrap.</h4>
                    
                    <!--a class="btn btn-primary js-scroll-trigger" href="#about">Get Started
                    </a-->    
                </div>
            </div>
        </header>
        <!-- About-->
        <section class="about-section text-center" id="about">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 mx-auto">
                        <h2 class="text-white mb-4" id="builtWith">Built with Bootstrap 4</h2>
                        <p class="text-white-50" id="builtDesc">
                            Grayscale is a free Bootstrap theme created by Start Bootstrap. It can be yours right now, simply download the template on
                            <a href="https://startbootstrap.com/template-overviews/grayscale/">the preview page</a>
                            . The theme is open source, and you can use it for any purpose, personal or commercial.
                        </p>
                    </div>
                </div>
                <img class="img-fluid" src="assets/img/ipad.png" alt="" />
            </div>
        </section>
        <!-- Projects-->
        <section class="projects-section bg-light" id="projects">
            <div class="container" id="pMother">
                <!-- Featured Project Row-->
                <div class="row align-items-center no-gutters mb-4 mb-lg-5">
                    <div class="col-xl-8 col-lg-7"><img class="img-fluid mb-3 mb-lg-0" src="assets/img/bg-masthead.jpg" alt="" /></div>
                    <div class="col-xl-4 col-lg-5">
                        <div class="featured-text text-center text-lg-left" id="feat">
                            <!--h4>Shoreline</h4-->
                            <p class="text-black-50 mb-0" id="showDrops">Grayscale is open source and MIT licensed. This means you can use it for any project - even commercial projects! Download it, customize it, and publish your website!</p>
                            <button class="btn btn-primary mx-auto" id="magicButton">자국들</button>
                        </div>
                    </div>
                </div>
                <!-- Project One Row-->
                <div class="row justify-content-center no-gutters mb-5 mb-lg-0" id="p1">
                    <div class="col-lg-6"><img class="img-fluid" src="assets/img/demo-image-01.jpg" alt="" /></div>
                    <div class="col-lg-6">
                        <div class="bg-black text-center h-100 project">
                            <div class="d-flex h-100">
                                <div class="project-text w-100 my-auto text-center text-lg-left">
                                    <h4 class="text-white">Misty</h4>
                                    <p class="mb-0 text-white-50">An example of where you can put an image of a project, or anything else, along with a description.</p>
                                    <hr class="d-none d-lg-block mb-0 ml-0" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Project Two Row-->
                <div class="row justify-content-center no-gutters" id="p2">
                    <div class="col-lg-6"><img class="img-fluid" src="assets/img/demo-image-02.jpg" alt="" /></div>
                    <div class="col-lg-6 order-lg-first">
                        <div class="bg-black text-center h-100 project">
                            <div class="d-flex h-100">
                                <div class="project-text w-100 my-auto text-center text-lg-right">
                                    <h4 class="text-white">Mountains</h4>
                                    <p class="mb-0 text-white-50">Another example of a project with its respective description. These sections work well responsively as well, try this theme on a small screen!</p>
                                    <hr class="d-none d-lg-block mb-0 mr-0" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!--게시판 시작-->
        <section>
            <div class="row align-items-center no-gutters mb-4 mb-lg-5">
                <div class="col-lg-8 mx-auto">
                    <table class="table">
                      <thead>
                        <tr>
                          <th scope="col">번호</th>
                          <th scope="col">글쓴이</th>
                          <th scope="col">내용</th>
                        </tr>
                      </thead>
                      <tbody id="tbody">
                      </tbody>
                    </table>
                    <!--페이징 시작-->
                    <nav aria-label="Page navigation example">
                        <p>총 글수 : <strong id="pagerTotal"></strong> </p>
                    <ul class="pagination justify-content-center" id="pagerReply">
                    </ul>
                    </nav>
                    <!--페이징 끝-->
                    <form id="replyForm">
                      <div class="form-group">
                        <label>내용</label>
                        <input type="text" class="form-control" id="content">
                      </div>
                      <div class="form-group">
                        <label>글쓴이</label>
                        <input type="text" class="form-control" id="writer">
                      </div>
                        <div class="form-group">
                        <label>패스워드</label>
                        <input type="password" class="form-control" id="password">
                      </div>
                    </form>

                    <button class="btn btn-primary" id="replySubmit">제출</button>
                    <button class="btn btn-primary" id="replyUpdate">수정</button>
                    <button class="btn btn-primary" id="replyDelete">삭제</button>

                </div>
            </div>
        </section>
        <!--게시판 끝-->
        <!-- Signup-->
        <section class="signup-section" id="signup">
            <div class="container">
                <div class="row">
                    <div class="col-md-10 col-lg-8 mx-auto text-center">
                        <i class="far fa-paper-plane fa-2x mb-2 text-white"></i>
                        <h2 class="text-white mb-5">Subscribe to receive updates!</h2>
                        <form class="form-inline d-flex">
                            <input class="form-control flex-fill mr-0 mr-sm-2 mb-3 mb-sm-0" id="inputEmail" type="email" placeholder="Enter email address..." />
                            <button class="btn btn-primary mx-auto" type="submit">Subscribe</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
        <!-- Contact-->
        <section class="contact-section bg-black">
            <div class="container">
                <div class="row">
                    <div class="col-md-4 mb-3 mb-md-0">
                        <div class="card py-4 h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-map-marked-alt text-primary mb-2"></i>
                                <h4 class="text-uppercase m-0">Address</h4>
                                <hr class="my-4" />
                                <div class="small text-black-50" id="address1">4923 Market Street, Orlando FL</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3 mb-md-0">
                        <div class="card py-4 h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-envelope text-primary mb-2"></i>
                                <h4 class="text-uppercase m-0">Email</h4>
                                <hr class="my-4" />
                                <div class="small text-black-50" ><a href="#!" id="email1">hello@yourdomain.com</a></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3 mb-md-0">
                        <div class="card py-4 h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-mobile-alt text-primary mb-2"></i>
                                <h4 class="text-uppercase m-0">Phone</h4>
                                <hr class="my-4" />
                                <div class="small text-black-50" id="phone1">+1 (555) 902-8832</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="social d-flex justify-content-center">
                    <a class="mx-2" href="#!"><i class="fab fa-twitter"></i></a>
                    <a class="mx-2" href="#!"><i class="fab fa-facebook-f"></i></a>
                    <a class="mx-2" href="#!"><i class="fab fa-github"></i></a>
                </div>
            </div>
        </section>
        <!-- Footer-->
        <footer class="footer bg-black small text-center text-white-50"><div class="container">Copyright © Your Website 2020</div></footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
        <!-- Third party plugin JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
       

        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>

        <script>

            //$("#title1").empty().append("김해원");
            //$("#p1").find("h4").empty().append("미스포츈");
            $("#magicButton").click(function(){
                $.get("http://localhost:8080/chara", function(data, status){
                    for(var i = 0 ; i < data.length ; i++){
                        //첫번째와 두번째 캐릭터 
                        if(i < 2){
                            $("#p"+(i+1)).find("h4").empty().append(data[i].name);
                            $("#p"+(i+1)).find("img").attr("src", "http://localhost:8080/" + data[i].img);
                            $("#p"+(i+1)).find("p").empty().append(data[i].album);
                        //세번째부터는 여기를 써라.
                        } else {
                            if(i%2 == 0){
                            //p1 copy
                                $("#p1").clone().attr("id", "p"+(i+1)).appendTo("#pMother");
                                $("#p"+(i+1)).find("h4").empty().append(data[i].name);
                                $("#p"+(i+1)).find("img").attr("src", "http://localhost:8080/" + data[i].img);
                                $("#p"+(i+1)).find("p").empty().append(data[i].album);
                            }else{
                            //p2 copy
                                $("#p2").clone().attr("id", "p"+(i+1)).appendTo("#pMother");
                                $("#p"+(i+1)).find("h4").empty().append(data[i].name);
                                $("#p"+(i+1)).find("img").attr("src", "http://localhost:8080/" + data[i].img);
                                $("#p"+(i+1)).find("p").empty().append(data[i].album);
                            }
                        }
                    }
                });
            });

            $("#contain1").find("img").attr("src", "http://localhost:8080/aa.jpg");



            //Subscribe Create
            $("#subscribe").click(function(){
                       var formData = {
                        "inputEmail":$("#inputEmail").val()
                        };

                       $.ajax({
                        url:'http://localhost:8080/subscribe',
                        type:'post',
                        contentType: 'application/json',
                        data:JSON.stringify(formData),
                        success:function(data){
                        console.log("성공");
                        //폼을 리셋하고
                        $('#subscribeForm')[0].reset();
                        getEmail();
                    }
                })
            });

            //Create
            $("#replySubmit").click(function(){
                    //서버에 보낼 데이터 생성
                    var formData = {
                    "content":$("#content").val() , 
                    "writer":$("#writer").val(), 
                    "password":$("#password").val()
                    };
                    //비동기 호출
                    //타입 GET / POST
                    $.ajax({
                    url:'http://localhost:8080/reply',
                    type:'post',
                    contentType: 'application/json',
                    data:JSON.stringify(formData),
                    //콜백
                    success:function(data){
                    console.log("성공");
                    //폼을 리셋하고
                    $('#replyForm')[0].reset();
                    //리플라이를 다시 불러오쟈
                    getReply();
                    setSubmitButton();
                    }

                    //error: function (ajaxContext) {
                    //     alert("수정실패");
                    //    $('#replyForm')[0].reset();
                    //    getReply();
                    //    setSubmitButton();
                    //}
                })
            });

            //Read
            function getReply(){
                $.get("http://localhost:8080/reply", function(data, status){
                    //기존 테이블 정보 삭제
                    $("#tbody").empty();
                    //데이터 삽입
                    for(var i = 0 ; i < data.replies.length ; i++){
                    //페이징 추가
                      $("#tbody").append('<tr><td><button onclick=setUpdateform('+data.replies[i].id+')>'+data.replies[i].id+'</button></td><td id=rw'+data.replies[i].id+'>'+data.replies[i].writer+'</td><td id=rc'+data.replies[i].id+'>'+data.replies[i].content+'</td></tr>');             
                    }
                    //페이징 버튼 추가 #pagerReply
                    $("#pagerTotal").empty().append(data.totalItems);
                    //<li class="page-item"><a class="page-link" href="/reply?size=3%page=1">1</a></li>
                    $("#pagerReply").empty();
                    for(var i = 0 ; i < data.totalPages ; i++){
                        if(data.currentPage != i){
                            $("#pagerReply").append('<li class="page-item"><button class="page-link" onclick=getReplyPage('+i+')>'+(i+1)+'</button></li>');
                        }else{
                             $("#pagerReply").append('<li class="page-item active"><button class="page-link" onclick=getReplyPage('+i+')>'+(i+1)+'</button></li>');
                        }
                    }
                    });
            }

            //Read with Page
            function getReplyPage(pageNumber){
                $.get("http://localhost:8080/reply?page="+pageNumber, function(data, status){
                    //기존 테이블 정보 삭제
                    $("#tbody").empty();
                    //데이터 삽입
                    for(var i = 0 ; i < data.replies.length ; i++){
                        //페이징 추가
                        $("#tbody").append('<tr><td><button onclick=setUpdateform('+data.replies[i].id+')>'+data.replies[i].id+'</button></td><td id=rw'+data.replies[i].id+'>'+data.replies[i].writer+'</td><td id=rc'+data.replies[i].id+'>'+data.replies[i].content+'</td></tr>');        
                    }

                //페이징 버튼 추가 #pagerReply
                $("#pagerTotal").empty().append(data.totalItems);
                //<li class="page-item"><a class="page-link" href="/reply?size=3%page=1">1</a></li>
                $("#pagerReply").empty();
                    for(var i = 0 ; i < data.totalPages ; i++){
                        if(data.currentPage != i){
                            $("#pagerReply").append('<li class="page-item"><button class="page-link" onclick=getReplyPage('+i+')>'+(i+1)+'</button></li>');
                        }else{
                             $("#pagerReply").append('<li class="page-item active"><button class="page-link" onclick=getReplyPage('+i+')>'+(i+1)+'</button></li>');
                        }
                    }
                });
            }
            
            //update
            $("#replyUpdate").click(function(){
                        //서버에 보낼 데이터 생성 
                       var formData = {
                        "content":$("#content").val() , 
                        "writer":$("#writer").val(), 
                        "password":$("#password").val()
                        };
                        //비동기 호출
                        //타입 GET / POST
                       $.ajax({
                        url:'http://localhost:8080/reply/'+$("#id").val(),
                        type:'put',
                        contentType: 'application/json',
                        data:JSON.stringify(formData),
                        //콜백
                        success:function(data){
                        console.log("수정성공");
                        //폼을 리셋하고
                        $('#replyForm')[0].reset();
                        //리플라이를 다시 불러오쟈
                        getReply();
                        setSubmitButton();
                        },
                        error: function (ajaxContext) {
                            alert("수정실패");
                            $('#replyForm')[0].reset();
                            getReply();
                        setSubmitButton();
                        }
                })
            });
            //delete
            $("#replyDelete").click(function(){
                        //서버에 보낼 데이터 생성 
                       var formData = { 
                        "content":$("#content").val() , 
                        "writer":$("#writer").val(), 
                        "password":$("#password").val()
                        };
                        //비동기 호출
                        //타입 GET / POST
                       $.ajax({
                        url:'http://localhost:8080/reply/'+$("#id").val(),
                        type:'delete',
                        contentType: 'application/json',
                        data:JSON.stringify(formData),
                        //콜백
                        success:function(data){
                        console.log("삭제성공");
                        //폼을 리셋하고
                        $('#replyForm')[0].reset();
                        //리플라이를 다시 불러오쟈
                        getReply();
                        setSubmitButton();
                        },
                        error: function (ajaxContext) {
                            alert("수정실패");
                             $('#replyForm')[0].reset();
                            getReply();
                        setSubmitButton();
                        }
                })
            });


            function setUpdateform(p1){
                console.log(p1);
                $("#id").val(p1);
                $("#writer").val($("#rw"+p1).text());
                $("#content").val($("#rc"+p1).text());
                setUpdateButton()
            }
                

            function setSubmitButton(){
             $("#replySubmit").show();
             $("#replyUpdate").hide();
             $("#replyDelete").hide();
            }
            

            function setUpdateButton(){
             $("#replySubmit").hide();
             $("#replyUpdate").show();
             $("#replyDelete").show();
            }


            //처음에 페이지가 실행 되었을때
            getReply();
            setSubmitButton();

            function getEmail(){
                $.get("http://localhost:8080/subscribe", function(data, status){
                for(var i = 0 ; i < data.length ; i++){
                      $("#tbody2").append("<tr><td>"+data[i].inputEmail+"</td></tr>");        
                        }
                    });
            } 
            getEmail();

            $("#title1").empty().append("waterdrops");
            $("#titleDesc").empty().append("WE GETHER DAILY DROPS");
            $("#builtWith").empty().append("What is Waterdrops?");
            $("#builtDesc").empty().append("Waterdrops는 매일의 물방울들을 모읍니다. 우리는 매일 각자의 흐름 속에서 외로운 작업을 이어갑니다. 여기는 우리가 수행한 것들을 하루 단위로 기록하고 공유하는 곳입니다. 그렇게 누군가 어디선가 매일 조금씩 나아가는 것을 서로 지켜봐줄 수 있길 바랍니다. 이 곳이 앞으로 다른 sns와 연동되는 것을 생각중입니다.");
//            $("#feat").empty().append("자국들을 여기서 볼 수 있습니다.");
            $("#showDrops").empty();
            
            $("#address1").empty().append("101, Seogangro 9gil Mapogu, Seoul");
            $("#email1").empty().append("kimhaewonmusic@gmail.com");
            $("#phone1").empty().append("010-2947-8448");

        </script>

    </body>
</html>
